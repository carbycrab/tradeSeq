<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>fitGAM — fitGAM • tradeSeq</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="fitGAM — fitGAM" />
<meta property="og:description" content="This fits the NB-GAM model as described in
Van den Berge et al.[2019].
There are two ways to provide the required input in fitGAM.
See Details and the vignette." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tradeSeq</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.5.09</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/tradeSeq.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Monocle.html">Using Monocle as input to **tradeSeq**</a>
    </li>
    <li>
      <a href="../articles/fitGAM.html">Fitting the models and additional control of fitGAM in **tradeSeq**</a>
    </li>
    <li>
      <a href="../articles/multipleConditions.html">Working with multiple conditions</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/statOmics/tradeSeq/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>fitGAM</h1>
    <small class="dont-index">Source: <a href='https://github.com/statOmics/tradeSeq/blob/master/R/AllGenerics.R'><code>R/AllGenerics.R</code></a>, <a href='https://github.com/statOmics/tradeSeq/blob/master/R/fitGAM.R'><code>R/fitGAM.R</code></a></small>
    <div class="hidden name"><code>fitGAM.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This fits the NB-GAM model as described in
Van den Berge et al.[2019].
There are two ways to provide the required input in <code>fitGAM</code>.
See Details and the vignette.</p>
    </div>

    <pre class="usage"><span class='fu'>fitGAM</span><span class='op'>(</span><span class='va'>counts</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S4 method for matrix</span>
<span class='fu'>fitGAM</span><span class='op'>(</span>
  <span class='va'>counts</span>,
  sds <span class='op'>=</span> <span class='cn'>NULL</span>,
  pseudotime <span class='op'>=</span> <span class='cn'>NULL</span>,
  cellWeights <span class='op'>=</span> <span class='cn'>NULL</span>,
  conditions <span class='op'>=</span> <span class='cn'>NULL</span>,
  U <span class='op'>=</span> <span class='cn'>NULL</span>,
  genes <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>counts</span><span class='op'>)</span><span class='op'>)</span>,
  weights <span class='op'>=</span> <span class='cn'>NULL</span>,
  offset <span class='op'>=</span> <span class='cn'>NULL</span>,
  nknots <span class='op'>=</span> <span class='fl'>6</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>,
  parallel <span class='op'>=</span> <span class='cn'>FALSE</span>,
  BPPARAM <span class='op'>=</span> <span class='fu'>BiocParallel</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/BiocParallel/man/register.html'>bpparam</a></span><span class='op'>(</span><span class='op'>)</span>,
  control <span class='op'>=</span> <span class='fu'>mgcv</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/mgcv/man/gam.control.html'>gam.control</a></span><span class='op'>(</span><span class='op'>)</span>,
  sce <span class='op'>=</span> <span class='cn'>TRUE</span>,
  family <span class='op'>=</span> <span class='st'>"nb"</span>,
  gcv <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span>

<span class='co'># S4 method for dgCMatrix</span>
<span class='fu'>fitGAM</span><span class='op'>(</span>
  <span class='va'>counts</span>,
  sds <span class='op'>=</span> <span class='cn'>NULL</span>,
  pseudotime <span class='op'>=</span> <span class='cn'>NULL</span>,
  cellWeights <span class='op'>=</span> <span class='cn'>NULL</span>,
  conditions <span class='op'>=</span> <span class='cn'>NULL</span>,
  U <span class='op'>=</span> <span class='cn'>NULL</span>,
  genes <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>counts</span><span class='op'>)</span><span class='op'>)</span>,
  weights <span class='op'>=</span> <span class='cn'>NULL</span>,
  offset <span class='op'>=</span> <span class='cn'>NULL</span>,
  nknots <span class='op'>=</span> <span class='fl'>6</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>,
  parallel <span class='op'>=</span> <span class='cn'>FALSE</span>,
  BPPARAM <span class='op'>=</span> <span class='fu'>BiocParallel</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/BiocParallel/man/register.html'>bpparam</a></span><span class='op'>(</span><span class='op'>)</span>,
  control <span class='op'>=</span> <span class='fu'>mgcv</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/mgcv/man/gam.control.html'>gam.control</a></span><span class='op'>(</span><span class='op'>)</span>,
  sce <span class='op'>=</span> <span class='cn'>TRUE</span>,
  family <span class='op'>=</span> <span class='st'>"nb"</span>,
  gcv <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span>

<span class='co'># S4 method for SingleCellExperiment</span>
<span class='fu'>fitGAM</span><span class='op'>(</span>
  <span class='va'>counts</span>,
  U <span class='op'>=</span> <span class='cn'>NULL</span>,
  genes <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>counts</span><span class='op'>)</span><span class='op'>)</span>,
  conditions <span class='op'>=</span> <span class='cn'>NULL</span>,
  weights <span class='op'>=</span> <span class='cn'>NULL</span>,
  offset <span class='op'>=</span> <span class='cn'>NULL</span>,
  nknots <span class='op'>=</span> <span class='fl'>6</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>,
  parallel <span class='op'>=</span> <span class='cn'>FALSE</span>,
  BPPARAM <span class='op'>=</span> <span class='fu'>BiocParallel</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/BiocParallel/man/register.html'>bpparam</a></span><span class='op'>(</span><span class='op'>)</span>,
  control <span class='op'>=</span> <span class='fu'>mgcv</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/mgcv/man/gam.control.html'>gam.control</a></span><span class='op'>(</span><span class='op'>)</span>,
  sce <span class='op'>=</span> <span class='cn'>TRUE</span>,
  family <span class='op'>=</span> <span class='st'>"nb"</span>,
  gcv <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span>

<span class='co'># S4 method for CellDataSet</span>
<span class='fu'>fitGAM</span><span class='op'>(</span>
  <span class='va'>counts</span>,
  U <span class='op'>=</span> <span class='cn'>NULL</span>,
  genes <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>counts</span><span class='op'>)</span><span class='op'>)</span>,
  weights <span class='op'>=</span> <span class='cn'>NULL</span>,
  offset <span class='op'>=</span> <span class='cn'>NULL</span>,
  nknots <span class='op'>=</span> <span class='fl'>6</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>,
  parallel <span class='op'>=</span> <span class='cn'>FALSE</span>,
  BPPARAM <span class='op'>=</span> <span class='fu'>BiocParallel</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/BiocParallel/man/register.html'>bpparam</a></span><span class='op'>(</span><span class='op'>)</span>,
  control <span class='op'>=</span> <span class='fu'>mgcv</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/mgcv/man/gam.control.html'>gam.control</a></span><span class='op'>(</span><span class='op'>)</span>,
  sce <span class='op'>=</span> <span class='cn'>TRUE</span>,
  family <span class='op'>=</span> <span class='st'>"nb"</span>,
  gcv <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>counts</th>
      <td><p>The count matrix of expression values, with genes
in rows and cells in columns. Can be a matrix or a sparse matrix.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>parameters including:</p></td>
    </tr>
    <tr>
      <th>sds</th>
      <td><p>an object of class <code>SlingshotDataSet</code>, typically obtained
after running Slingshot. If this is provided, <code>pseudotime</code> and
<code>cellWeights</code> arguments are derived from this object.</p></td>
    </tr>
    <tr>
      <th>pseudotime</th>
      <td><p>A matrix of pseudotime values, each row represents a cell
and each column represents a lineage.</p></td>
    </tr>
    <tr>
      <th>cellWeights</th>
      <td><p>A matrix of cell weights defining the probability that a
cell belongs to a particular lineage. Each row represents a cell and each
column represents a lineage. If only a single lineage, provide a matrix with
one column containing all values of 1.</p></td>
    </tr>
    <tr>
      <th>conditions</th>
      <td><p>This argument is in beta phase and should be used carefully.
If each lineage consists of multiple conditions, this argument can be used to
specify the conditions. tradeSeq will then fit a condition-specific smoother for
every lineage.</p></td>
    </tr>
    <tr>
      <th>U</th>
      <td><p>The design matrix of fixed effects. The design matrix should not
contain an intercept to ensure identifiability.</p></td>
    </tr>
    <tr>
      <th>genes</th>
      <td><p>The genes on which to run <code>fitGAM</code>. Default to all the genes.
If only a subset of the genes is indicated, normalization will be done using
all the genes but the smoothers will be computed only for the subset.</p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>A matrix of weights with identical dimensions
as the <code>counts</code> matrix. Usually a matrix of zero-inflation weights.</p></td>
    </tr>
    <tr>
      <th>offset</th>
      <td><p>The offset, on log-scale. If NULL, TMM is used to account for
differences in sequencing depth., see <code><a href='https://rdrr.io/pkg/edgeR/man/calcNormFactors.html'>edgeR::calcNormFactors</a></code>.
Alternatively, this may also be a vector with length equal to the number of
cells.</p></td>
    </tr>
    <tr>
      <th>nknots</th>
      <td><p>Number of knots used to fit the GAM. Defaults to 6. It is
recommended to use the `evaluateK` function to guide in selecting an
appropriate number of knots.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Logical, should progress be printed?</p></td>
    </tr>
    <tr>
      <th>parallel</th>
      <td><p>Logical, defaults to FALSE. Set to TRUE if you want to
parallellize the fitting.</p></td>
    </tr>
    <tr>
      <th>BPPARAM</th>
      <td><p>object of class <code>bpparamClass</code> that specifies the
back-end to be used for computations. See
<code>bpparam</code> in <code>BiocParallel</code> package for details.</p></td>
    </tr>
    <tr>
      <th>control</th>
      <td><p>Variables to control fitting of the GAM, see
<code>gam.control</code>.</p></td>
    </tr>
    <tr>
      <th>sce</th>
      <td><p>Logical: should output be of SingleCellExperiment class? This is
recommended to be TRUE. If <code>sds</code> argument is specified, it will always
be set to TRUE</p></td>
    </tr>
    <tr>
      <th>family</th>
      <td><p>The assumed distribution for the response. Is set to <code>"nb"</code>
by default.</p></td>
    </tr>
    <tr>
      <th>gcv</th>
      <td><p>(In development). Logical, should a GCV score also be returned?</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>If <code>sce=FALSE</code>, returns a list of length equal to the number of genes
 (number of rows of <code>counts</code>). Each element of the list is either a
  <code>gamObject</code> if the fiting procedure converged, or an error
   message.
If <code>sce=TRUE</code>, returns a <code>singleCellExperiment</code> object with
the <code>tradeSeq</code> results stored in the <code>rowData</code>,
<code>colData</code> and <code>metadata</code>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>fitGAM</code> supports four different ways to input the required objects:</p><ul>
<li><p>"Count matrix, matrix of pseudotime and matrix of cellWeights."
Input count matrix using <code>counts</code> argument and
pseudotimes and cellWeights as a matrix, with number of rows equal to
number of cells, and number of columns equal to number of lineages.</p></li>
<li><p>"Count matrix and Slingshot input."Input count matrix using
<code>counts</code> argument and Slingshot object using <code>sds</code> argument.</p></li>
<li><p>"SingleCellExperiment Object after running slingshot on the object."
Input SingleCellExperiment Object using <code>counts</code> argument.</p></li>
<li><p>"CellDataSet object after running the <code>orderCells</code> function."
Input CellDataSet Object using <code>counts</code> argument.</p></li>
</ul>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>8</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>crv</span>, package<span class='op'>=</span><span class='st'>"tradeSeq"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>countMatrix</span>, package<span class='op'>=</span><span class='st'>"tradeSeq"</span><span class='op'>)</span>
<span class='va'>gamList</span> <span class='op'>&lt;-</span> <span class='fu'>fitGAM</span><span class='op'>(</span>counts <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='va'>countMatrix</span><span class='op'>)</span>,
                  sds <span class='op'>=</span> <span class='va'>crv</span>,
                  nknots <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Koen Van den Berge, Hector Roux de Bezieux, Lieven Clement.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


